;1)
(define (make-phone-book name number left right)
  (list (cons name number) left right))
(make-phone-book "mac" 2952835021 '() '())
;2)
(define (get-name book)
  (car (car book)))
(get-name (make-phone-book "mac" 2952835021 '() '()))

(define (get-number book)
  (cdr (car book)))
(get-number (make-phone-book "mac" 2952835021 '() '()))

;(car (cdr book))
(define (get-left book)
  (cadr book))
(get-left (make-phone-book "mac" 2952835021 '() '()))

(define (get-right book)
  (car (cdr (cdr book))))
(get-right (make-phone-book "mac" 2952835021 '() '()))

;3)
(define (insert book name number)
    (cond ((null? book)
           (make-phone-book name number '() '()))
          ((string=? name (get-name book))
           book)
          ((string<? name (get-name book))
           (make-phone-book (get-name book) (get-number book)
                            (insert (get-left book) name number) (get-right book)))
          ((string>? name (get-name book))
           (make-phone-book (get-name book) (get-number book)
                            (get-left book) (insert (get-right book) name number)))))
(insert (make-phone-book "mac" 2952835021 '() '()) "john" 8951697257)

;4)
(define (insert-all book L)
  (cond ((null? L)
           book)
        (else (insert-all (insert book (car (car L)) (cdr (car L))) (cdr L)))))
(insert-all (make-phone-book "mac" 4693582 '() '()) (list (cons "Herbert" 5550001) (cons "Mortimer" 5550002) (cons "Oscar" 5550003)
(cons "Stanley" 5550004) (cons "Walter" 5550005) (cons "Gordon" 5550006)
(cons "Larry" 5550007) (cons "George" 5550008) (cons "Henry" 5550009)
(cons "Donald" 5550010) (cons "Harry" 5550011) (cons "Franklin" 5550012)
(cons "Arthur" 5550014) (cons "Vernon" 5550015) (cons "Fran" 5550016)
(cons "Betty" 5550017) (cons "Mona" 5550018) (cons "Agnes" 5550019)
(cons "Gertrude" 5550020) (cons "Esmerelda" 5550021)
(cons "Ursula" 5550022) (cons "Adele" 5550023) (cons "Edwina" 5550024)
(cons "Geraldine" 5550025) (cons "Maggie" 5550026) (cons "Pearl" 5550027)
(cons "Winifred" 5550028) (cons "Uma" 5550029) (cons "Thelma" 5550030)
(cons "Peter" 5550013)))

;5)
(define (phone-book-look-up book name)
  (cond ((null? book)
         "name not found")
         ((string=? name (get-name book)) (get-number book))
         ((string>? name (get-name book)) 
          (phone-book-look-up (get-left book) name))
         ((string<? name (get-name book)) 
          (phone-book-look-up (get-right book) name))))
(phone-book-look-up (make-phone-book "mac" 4693582 '() '()) "l")
(phone-book-look-up (make-phone-book "mac" 4693582 '() '()) "mac")

;6)
;bottom of tree (smallest)
;last is top of tree (largest) 
(define (first-number book)
    (cond ((null? book) '())
          ((null? (get-left book))
           (cons (get-name book) (get-number book)))
          (else (first-number (get-left book)))))
(first-number (insert-all (make-phone-book "mac" 4693582 '() '()) (list (cons "Herbert" 5550001) (cons "Mortimer" 5550002) (cons "Oscar" 5550003)
(cons "Stanley" 5550004) (cons "Walter" 5550005) (cons "Gordon" 5550006)
(cons "Larry" 5550007) (cons "George" 5550008) (cons "Henry" 5550009)
(cons "Donald" 5550010) (cons "Harry" 5550011) (cons "Franklin" 5550012)
(cons "Arthur" 5550014) (cons "Vernon" 5550015) (cons "Fran" 5550016)
(cons "Betty" 5550017) (cons "Mona" 5550018) (cons "Agnes" 5550019)
(cons "Gertrude" 5550020) (cons "Esmerelda" 5550021)
(cons "Ursula" 5550022) (cons "Adele" 5550023) (cons "Edwina" 5550024)
(cons "Geraldine" 5550025) (cons "Maggie" 5550026) (cons "Pearl" 5550027)
(cons "Winifred" 5550028) (cons "Uma" 5550029) (cons "Thelma" 5550030)
(cons "Peter" 5550013))))

(define (last-number book)
  (cond ((null? book) '())
        ((null? (get-right book))
         (cons (get-name book) (get-number book)))
        (else (last-number (get-right book)))))
(last-number (insert-all (make-phone-book "mac" 4693582 '() '()) (list (cons "Herbert" 5550001) (cons "Mortimer" 5550002) (cons "Oscar" 5550003)
(cons "Stanley" 5550004) (cons "Walter" 5550005) (cons "Gordon" 5550006)
(cons "Larry" 5550007) (cons "George" 5550008) (cons "Henry" 5550009)
(cons "Donald" 5550010) (cons "Harry" 5550011) (cons "Franklin" 5550012)
(cons "Arthur" 5550014) (cons "Vernon" 5550015) (cons "Fran" 5550016)
(cons "Betty" 5550017) (cons "Mona" 5550018) (cons "Agnes" 5550019)
(cons "Gertrude" 5550020) (cons "Esmerelda" 5550021)
(cons "Ursula" 5550022) (cons "Adele" 5550023) (cons "Edwina" 5550024)
(cons "Geraldine" 5550025) (cons "Maggie" 5550026) (cons "Pearl" 5550027)
(cons "Winifred" 5550028) (cons "Uma" 5550029) (cons "Thelma" 5550030)
(cons "Peter" 5550013))))

;7) book --> list reverse alphabetical order
(define (traverse book)
  (cond ((null? book) '())
        (append (list (traverse (get-right book))
                      (get-name book)
                      (traverse (get-left book))))))
(traverse (make-phone-book "mac" 2952835021 '() '()))